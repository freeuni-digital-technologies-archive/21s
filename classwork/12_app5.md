---
title: 12. ვებ აპლიკაცია 5 - პოსტის წაშლა, ავტორიზაციის გვერდი
parent: სემინარები
---

## პოსტის წაშლა
 პირველ რიგში პოსტის წასაშლელად დავამატოთ წაშლის ღილაკი. მოდი რადგან getPostLikeElem ცალკე ფუნქციად გვაქვს გატანილი შეგვიძლია მასში დავამატოთ ახალი ღილაკი, რომელზე დაჭერის შედეგადაც გამოიძახება deletePost ფუნქცია და გადაეცემა მას პოსტის აიდი.
```js
function getPostLikesElem(post) {
	return `<span class="post-likes-number">${post.likes}</span> likes
			<button onclick="likePost(${post.id})" class="post-like-button">like</button>
			<button onclick="deletePost(${post.id})">delete</button>`
}
```
deletePost ფუნქციაში გამოვიძახოთ deleteElement ფუნქცია რომელსაც დაევალება ელემენტის ვიზუალურად წაშლა, ხოლო ბოლო ხაზზე დაწერილი კოდით წავშალოთ ბაზიდან ელემენტი.
```js
function deletePost(postId) {
	// წავშალოთ ელემენტი
	deleteElement('post' + postId)
	// წავშალოთ მონაცემი
	posts.delete(postId)
}
```
deleteElement ფუნქციაში კი უკვე ამოვიღოთ შესაბამისი ელემენტი და წავშალოთ ეს ელემენტი (ყურადღება მიაქციეთ, რომ ეს არის ელემენტის id (ანუ მაგალითად "post13") და არა პოსტის id number (13). ამის გამო ვწერთ querySelectorში პირდაპირ '#' + id და არა '#post' + id)
```js
function deleteElement(id) {
	let elem = document.querySelector('#' + id)
	elem.parentNode.removeChild(elem)
}
```
## ავტორიზაციის გვერდი
ავტორიზაციის შესაქმნალად გვჭირდება დამატებით ერთი HTML და ერთი JS ფაილი, HTML ფაილში ჩავყაროთ ორი ინფუთ ელემენტი და ორი ღილაკი რომელებსაც ერთერთს მივაბავთ ლოგინის ფუნქციას ერთერთს რეგისტრაციის ფუნქციას. ასევე მივაბათ ბაზების და რეგისტაციის ჯავასკრიპტ ფაილები.
```html
    <div><input type="text" id="username"></div>
	<div><input type="text" id="password"></div>
	<div>
		<button onclick="register()">register</button>
		<button onclick="login()">login</button>
	</div>
	<script src="database.js"></script>
	<script src="register.js"></script>
```
რაც შეეხება უკვე JS ფაილს პირველ რიგში ისევ ბაზასთან დავაკავშიროთ 
```js
let users = new Database('users')
```
შემდეგ გავწეროთ რეგისტრაციის ფუნქცია, ამ ფუნქციაში ჯერ წავიკითხოთ შეყვანილი მონაცემები დამხმარე getData() ფუნქციის საშუალებით, შემდეგ შემოვიღოთ ახალი ბულიან ტიპის ცვლადი existingUser რომელიც თუ ესეთი user უკვე არსებობს დააბრუნებს true-ს ხოლო თუ არ არსებობს false. შემდეგ if else-ში კი გავწეროთ თუ ესეთი იუზერი არ არსებობს შევქმნათ ამ სახელით და პაროლით, თუ არადა დავაბრუნოთ alert რომ ესეთი იუზერი უკვე არსებობს 
```js
function register() {
	// წავიკითხოთ შეყვანილი მონაცემები
	let user = getData()
	// შევქმნათ ახალი იუზერი
	// users.create(user)
	// დავამატოთ შემოწმება
	let existingUser = users.get('username', user.username)
	// users.get დააბრუნებს null-ს თუ ვერ მოიძებნა.
	// null შეგვიძლია გამოვიყენოთ როგორც false
	// ანუ თუ არ არსებობს ასეთი მომხმარებელი
	if(!existingUser) {
		user = users.create(user)
	} else {
		alert('user already exists')
	}
}
```
ერთადერთი რაც ამის შემდეგ დასაწერი დაგვრჩება არის getData() რის შემდეგაც რეგისტრაცია გაიმართება. getData-ში კი უკვე ვაბრუნებთ შესაბამისად username და password-ში ჩაწერილ ტექსტებს.

```js
function getData() {
	return {
		username: document.querySelector('#username').value,
		password: document.querySelector('#password').value
	}
}
```
